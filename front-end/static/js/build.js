(()=>{var f=(n,t,i,l)=>{let o=document.createElement("input");return o.type=n,o.className=l,o.name=t,o.placeholder=i,o};function d(n){let t=document.querySelector(`${n} #ingredients_div`),i=t.querySelectorAll(".ingredient_name");i[i.length-1].addEventListener("focusout",()=>{let l=f("text","ingredient_name","name of ingredient","ingredient_name"),o=f("text","ingredient_amount","amount of ingredient","ingredient_amount");t.appendChild(l),t.appendChild(o),d(n)},{once:!0})}var m="http://localhost:4000/api/recipes";u();async function u(){await p(),await g(a),await h()}async function g(n=null){let t=await fetch(`${m}`);if(t=await t.json(),n!==null)n(t);else return t}async function p(){let n=["categories","ingredients","difficulty"],t=await g();for(let i of n){let l=document.getElementById(i),o=document.getElementById(`${i}-content`),e=await fetch(`${m}/${i}`);e=await e.json();let r="";for(let c of e)r+=`<p id="${c}">${c}</p>`;r+=`<p id='${i}-all'>ALL</p>`,o.innerHTML=r,l.addEventListener("click",()=>{o.classList.toggle("visible"),l.classList.toggle("visible")});for(let c of e)document.getElementById(c).addEventListener("click",()=>{a(t,i,c)});document.getElementById(`${i}-all`).addEventListener("click",()=>{console.log("click"),a(t)})}}function a(n,t="",i=""){let l=document.getElementById("recipes"),o="";t==="categories"?n=n.filter(e=>e.category===i):t==="ingredients"?n=n.filter(e=>e.ingredients.some(r=>r.name.toLowerCase()===i.toLowerCase())):t==="difficulty"&&(n=n.filter(e=>e.difficulty===i)),n.forEach(e=>{o+=`<a href="detail.html?id=${e.id}" id="${e.title}" class="card">
    <h2>${e.title}</h2>
    <img src="static/media/images/${e.image}" alt="image of the recipe">
    <p>This recipe is for ${e.servings} people</p>
    <p>difficulty: ${e.difficulty}</p>
    </a>`}),l.innerHTML=o}async function h(){let n=document.getElementById("message_Added_Recipe"),t=document.getElementById("Add_Recipe");d("#Add_Recipe"),t.addEventListener("submit",async()=>{let i=new FormData(t),l=i.getAll("ingredient_name"),o=i.getAll("ingredient_amount"),e={};i.forEach((s,c)=>{(c!=="ingredient_name"||c!=="ingredient_amount"||c!=="")&&(e[c]=s,console.log(c,s))});let r=[];l.forEach((s,c)=>{l[l.length-1]!==s&&r.push({name:s.value,amount:o[c].value})}),e+={image:"imageLess.webp",ingredients:r},console.log(e),await fetch(m,{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(e)}).then(s=>s.json()).then(s=>s=n.innerHTML=s.message).catch(s=>console.error(s.message))})}})();
